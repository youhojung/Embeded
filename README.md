## 임베디드통신시스템 2주차 실습

## 회로도

![회로도](https://github.com/user-attachments/assets/ab77fc50-74ea-4996-94e7-afc7b84a9bfc)


## 동작 시연

[https://youtu.be/jD3jkI3LD5E](https://youtu.be/dmyctRXx0_g)

## 기본 기능  
- 빨간 LED (2초) → 노란 LED (0.5초) → 초록 LED (2초) → 초록 LED 깜빡임 (3회, 총 1초) 반복  

## 카메라를 통한 손 인식
카메라에서 손을 인식하면, ml5를 통해 손 모델을 불러와 손의 끝과 관절 등에 빨간 점을 찍는다.
각 손가락이 구부러졌는지 펴졌는지 구별하는 알고리즘은 다음과 같다.

## 손가락 구부러짐/펴짐 구별 알고리즘

![Image](https://github.com/user-attachments/assets/8c659c22-e681-4d7c-94fc-259756e14997)

**엄지 손가락의 경우**
엄지손가락은 다른 손가락과는 다르게 x축 이동이 두드러진다.
엄지손가락 부분의 경우, mcp와 cmc는 손가락을 단순히 구부리거나 피는 것 만으로는 상대적 위치가 거의 변하지 않는다.
그러나 tip부분은 손가락을 구부리거나 폈을 때, mcp의 x값을 지나다닌다.
따라서 (tip1.x - mcp1.x) * (mcp1.x - cmc1.x)의 값이 양수인지 음수인지 계산하면, 엄지 손가락이 구부러졌는지 펴졌는지를 알 수 있다.
양수인 경우 엄지 손가락은 펴져있고, 음수인 경우 엄지 손가락은 구부러져 있다.
**다른 손가락의 경우**
엄지를 제외한 손가락은 y축 이동이 두드러진다.
손가락이 펴져있다면, tip3.y - pip3.y과 pip3.y - mcp3.y는 같은 +-값을 가지게 될 것이다.
두 값을 곱했을 때 양수이면 같은 +-값을 가지고 있다는 뜻이므로 손가락이 펴져있다는 뜻이다.
두 값을 곱했을 때 음수라면 다른 +-값을 가지고 있다는 뜻이므로 손가락이 구부러져있다는 뜻이다.

## 모드 전환  
버튼을 누르면 **Emergency, Blink All, PowerOff** 모드로 전환할 수 있다.  
다시 한 번 버튼을 누르면 **Normal 모드**로 돌아가며, 빨간 LED가 켜지는 것부터 다시 실행된다.

p5.js와의 시리얼 통신을 통해, 제스처를 통한 시리얼 통신이 가능하다.
검지/중지 손가락을 펴는 것은 **Normal 모드**
모든 손가락을 펴는 것은 **Emergency 모드**
검지/중지/약지를 펴는 것은 **Blink All 모드**
모든 손가락을 구부리는 것은 **Power Off 모드**를 의미한다.
